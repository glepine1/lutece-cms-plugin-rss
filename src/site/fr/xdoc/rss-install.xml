<?xml version="1.0" encoding="UTF-8"?>
<document>
    <properties>
        <title>
            Installation du plugin RSS
        </title>
    </properties>
    <body>
        <section name="Installation du plugin RSS">
            <subsection name="Caractéristiques">
                <p>
                    <ul>
                        <li>La fonction RSS est mise en oeuvre au travers d’un plugin
                            dédié,
                        </li>
                        <li>Il n’existe pas d’interface de publication dans le menu «
                            administration du site ». Chaque webmestre pourra proposer
                            dans une rubrique de type « Html texte libre » la liste des
                            URL vers ses fichiers RSS.
                        </li>
                        <li>La norme utilisée pour l’implémentation de la fonction de
                            RSS est la version 2.0.
                        </li>
                    </ul>
                </p>
                <p>
					Le plugin RSS dispose de trois démons :
                	<ul>
                		<li>generateRssFiles : création/mise à jour des flux RSS internes</li>
                		<li>fetchRssFeeds : récupération des flux RSS externes</li>
                		<li>resetRssFeeds : Suppression du cache pour les flux RSS externes</li>
                	</ul>
               	</p>
               	<p>Le paramètrage des démons s'effectue dans le fichier de configuration du plugin (voir section <a href="#Configuration">Configuration</a>).</p>
            </subsection>
            <subsection name="Installation des binaires">
                <p>
                    L'installation des binaires suit la procédure habituelle
                    pour les plug- ins : il faut arrêter le serveur Tomcat et
                    décompresser le fichier <code>plugin-rss-bin-XXXXXX.zip</code> dans
                    le répertoire de base de la webapp.
                </p>
            </subsection>
            <subsection name="Modification de la base de données">
                <p>Ce plug-in nécessite la création d'une nouvelle table dans
                    la base de données. Pour cela, lancer les scripts
                    situés dans le répertoire <code>sql/plugins/rss</code>.
                </p>
            </subsection>
            <subsection name="Configuration">
                <h4>
                    Configuration des fichiers de Lutèce
                </h4>
                <ul>
               		<li><code>WEB-INF/conf/lutece.properties</code> :
                   		répertoire de la webapp destiné au stockage des données
                           des plug-ins : <code>path.plugins.warehouse=/plugins</code>
                   	</li>
                   	<li><code>WEB-INF/conf/config.properties</code>
                   		Les URLs contenues dans les fichiers RSS générés sont basées sur la propriété :
               			<code>lutece.prod.url</code> Elle doit donc être renseignée.
               		</li>
               	</ul>
                <h4>
                    Fichier de configuration du plug-in :
                    <code>WEB-INF/conf/plugins/rss.properties</code>
                </h4>
                <blockquote>Attention, pour les fichiers de propriété, le caractère d'échappement est l'anti-slash (\). Pour écrire un anti-slash, il faut écrire \\.</blockquote>
                <p>
                    <ul>
                    	<li>Nombre de flux RSS à afficher par page dans l'interface d'administration :
                    		<code>rss.rssPerPage=5</code>
                    	</li>
                    	<li>Configuration du proxy :
                    		<ul>
                    			<li><code>rss.httpAccess.proxyHost</code></li>
                    			<li><code>rss.httpAccess.proxyPort</code></li>
                    			<li><code>rss.httpAccess.proxyUserName</code></li>
                    			<li><code>rss.httpAccess.proxyPassword</code></li>
                    			<li><code>rss.httpAccess.hostName</code></li>
                    			<li><code>rss.httpAccess.domainName</code></li>
                   			</ul>
                    	</li>
                    	<li>Langue utilisée pour la génération des flux RSS :
                    		<code>rss.language=fr-fr</code>
                    	</li>
                    	<li>Extension des fichiers RSS générés :
                    		<code>rss.file.type=.xml</code>
                    	</li>
                    	<li>Nom du répertoire de stockage des fichiers RSS :
                    		<code>rss.storage.directory.name=rss</code>
                    	</li>
                    	<li>Taille maximale des noms des fichiers :
                    		<code>rss.name.max.length=60</code>
                    	</li>
                    </ul>
                	<p>
                    Paramètres de configuration des démons :
                    </p>
                    <ul>
                    	<li>intervalle de lancement (en secondes) :
	                        <code>daemon.xxx.interval=300</code>
                    	</li>
                    	<li>lancement au démarrage du système (0 = non, 1 = oui) :
	                        <code>daemon.xxx.onstartup=1</code>
                    	</li>
                	</ul>
                
                </p>
            </subsection>
            <subsection name="Création du répertoire de stockage des fichiers RSS">
                <p>
                    Créer le répertoire défini par les deux propriétés
                    décrites ci-dessus :
                    <div class="source">
                    <pre>
path.plugins.warehouse/rss.storage.directory.name
                    </pre>
                    </div>
                    Les droits en lecture et écriture doivent être donnés pour ce
                    répertoire.
                    Les noms des fichiers RSS générés par l’application et stockés
                    dans ce répertoire ne doivent jamais être modifiés, car ils
                    sont aussi stockés dans la table <code>rss_generation</code> de la
                    base de données. Par conséquent il faut toujours vérifier la
                    cohérence entre la base et le contenu du répertoire.
                </p>
                <p>
                    Si un fichier RSS correspondant à une rubrique est généré dans
                    le répertoire et si par la suite la rubrique est supprimée, le
                    fichier ne sera pas pour autant supprimé afin de ne pas
                    provoquer une erreur d’affichage pour l’internaute qui aurait
                    créé un lien vers ce fichier.
                </p>
            </subsection>
            <subsection name="Activation du plug-in">
                <p>
                    Cette opération s'effectue aprè le redémarrage de Tomcat
                    et permet de mettre à disposition du webmestre la fonction RSS.
                    Elle est similaire à l’activation de n’importe quel
                    plugin.
                </p>
                <p>
                    Il faut sélectionner le menu « gestion des plugins » en étant
                    connecté comme administrateur. On sélectionne l’action «
                    activer » pour le plugin « rss ».
                    Dans le menu « gestion des utilisateurs » on sélectionne
                    l’utilisateur et on modifie ses droits afin de lui donner accès
                    à la fonction « rss ».
                </p>
            </subsection>
        </section>
    </body>
</document>  
  